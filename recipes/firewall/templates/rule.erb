<% unless protocol.empty? -%>
-p <%= protocol + " " -%>
<% end -%>
<% for m in modules -%>
-m <%= m + " " -%>
<% end -%>
<% unless destination_range.empty? -%>
--dst-range <%= destination_range + " " -%>
<% end -%>
<% unless source_range.empty? -%>
--src-range <%= source_range + " " -%>
<% end -%>
<% unless out_interface.empty? -%>
--out-interface <%= out_interface + " " -%>
<% end -%>
<% unless in_interface.empty? -%>
--in-interface <%= in_interface + " " -%>
<% end -%>
<% unless source.empty? -%>
--source <%= source + " " -%>
<% end -%>
<% unless uid_owner.empty? -%>
--uid-owner <%= uid_owner + " " -%>
<% end -%>
<% unless state.empty? -%>
--state <%= state + " " -%>
<% end -%>
<% unless mode.empty? -%>
--mode <%= mode + " " -%>
<% end -%>
<% unless not_physdev_bridged.empty? -%>
! --physdev-is-bridged
<% end -%>
<% unless every.empty? -%>
--every <%= every + " " -%>
<% end -%>
<% unless destination.empty? -%>
--destination <%= destination + " " -%>
<% end -%>
<% unless destination_port.empty? -%>
<% if destination_port =~ /:|,/ -%>
-m multiport --destination-ports <%= destination_port + " " -%>
<% else -%>
--destination-port <%= destination_port + " " -%>
<% end -%>
<% end -%>
<% unless source_port.empty? -%>
<% if source_port =~ /:|,/ -%>
-m multiport --source-ports <%= source_port + " " -%>
<% else -%>
--source-port <%= source_port + " " -%>
<% end -%>
<% end -%>
<% if operatingsystemrelease == '5' -%>
-m comment --comment "<%= comment -%>"<%= " " -%>
<% end -%>
-j <%= action -%>
<% unless to_ports.empty? -%>
 --to-ports <%= to_ports + " " -%>
<% end -%>
<% unless to_destination.empty? -%>
 --to-destination <%= to_destination + " " -%>
<% end -%>
<% unless log_prefix.empty? -%>
--log-prefix <%= log_prefix + " " -%>
<% end -%>
<% unless reject_with.empty? -%>
--reject-with <%= reject_with + " " -%>
<% end -%>
<%# keep at end %>
